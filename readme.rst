Major work in progress, I wouldn't expect these to be terribly portable or
robust just yet.
